clear; close all;

d = [0, 1.3, 3.9, 1.7, 3.0; 1.3, 0, 2.4, 4.5, 5.7; 3.9, 2.4, 0, 1.2, 6.1; 1.7, 4.5, 2.5, 0, 2.2; 3.0, 5.7, 6.1, 2.2, 0];

G = zeros(4,2);
G(1,1) = d(5,1); G(2,1) = d(5,2); G(3,1) = d(5,3); G(4,1) = d(5,4);
G(:,2) = [1, 2, 3, 4];

H = zeros(6,2);
[H(1,1), H(1,2)] = min([G(1,1) + d(G(1,2),2), G(2,1) + d(G(2,2),1)]);
[H(2,1), H(2,2)] = min([G(1,1) + d(G(1,2),3), G(3,1) + d(G(3,2),1)]);
[H(3,1), H(3,2)] = min([G(2,1) + d(G(2,2),3), G(3,1) + d(G(3,2),2)]);
[H(4,1), H(4,2)] = min([G(1,1) + d(G(1,2),4), G(4,1) + d(G(4,2),1)]);
[H(5,1), H(5,2)] = min([G(2,1) + d(G(2,2),4), G(4,1) + d(G(4,2),2)]);
[H(6,1), H(6,2)] = min([G(3,1) + d(G(3,2),4), G(4,1) + d(G(4,2),3)]);

H(1,2) = 2; H(2,2) = 3; H(3,2) = 3; H(4,2) = 4; H(5,2) = 4; H(6,2) = 4;

L = zeros(4,2);
[L(1,1), L(1,2)] = min([H(1,1) + d(H(1,2),3), H(2,1) + d(H(2,2),2), H(3,1) + d(H(3,2),1)]);
[L(2,1), L(2,2)] = min([H(1,1) + d(H(1,2),4), H(4,1) + d(H(4,2),2), H(5,1) + d(H(5,2),1)]);
[L(3,1), L(3,2)] = min([H(2,1) + d(H(2,2),4), H(4,1) + d(H(4,2),3), H(6,1) + d(H(6,2),1)]);
[L(4,1), L(4,2)] = min([H(3,1) + d(H(3,2),4), H(5,1) + d(H(5,2),3), H(6,1) + d(H(6,2),2)]);

L(1,2) = 3; L(2,2) = 2; L(3,2) = 3; L(4,2) = 3;

S = zeros(1,2);
[S(1,1), S(1,2)] = min([L(1,1) + d(L(1,2),4)+d(4,5), L(2,1) + d(L(2,2),3)+d(3,5), L(3,1) + d(L(3,2),2)+d(2,5), L(4,1) + d(L(4,2),1)+d(1,5)]);
S(1,2) = 4;

cost = S(1,1);
path = zeros(6,1);
path(6) = 5;
path(5) = S(1,2);
path(4) = L(1,2);
path(3) = H(1,2);
path(2) = G(1,2);
path(1) = 5;
